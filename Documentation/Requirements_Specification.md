# 📋 ArcCore 프로젝트 요구 사항 명세서

## 1. 개요

`ArcCore`는 C++ 기반의 고성능 MMORPG 게임 서버 포트폴리오 프로젝트로, 안정적인 동시 접속 처리와 효율적인 게임 데이터 관리에 중점을 둡니다. 본 문서는 `ArcCore` 서버가 제공하는 주요 기능 및 시스템 성능 요구 사항을 정의하며, 각 기능의 구현 우선순위를 명시합니다.

## 2. 핵심 기술 스택

* **언어**: C++17
* **입출력 모델**: IOCP (I/O Completion Port)
* **네트워크 API**: Winsock (TCP/IP)
* **데이터베이스**: MySQL 8.0
* **직렬화**: Google Protobuf
* **패키지 관리**: vcpkg
* **로깅**: spdlog
* **테스트**: Google Test
* **클라이언트**: Unity 6.0 LTS

## 3. 기능 요구 사항 (Functional Requirements)

### 3.1. 네트워크 통신

* **IOCP 기반 비동기 네트워크 처리**: 고성능 및 확장성을 위해 IOCP 모델을 사용하여 다수의 클라이언트 요청을 효율적으로 처리해야 합니다.
* **TCP/IP 통신**: 안정적인 데이터 전송을 위해 TCP/IP 프로토콜을 사용해야 합니다.
* **패킷 직렬화/역직렬화**: Google Protobuf를 활용하여 효율적이고 견고한 패킷 구조를 정의하고, 클라이언트-서버 간 데이터 통신에 사용해야 합니다.
* **클라이언트 세션 관리**: 접속한 클라이언트들의 연결 상태를 관리하고, 유효하지 않거나 종료된 세션을 적절히 처리해야 합니다.

### 3.2. 게임 로직 처리

* **계정 및 로그인/로그아웃**:
    * 사용자 계정 생성 및 관리 (회원가입).
    * 유효한 계정 정보를 통한 서버 로그인 및 로그아웃 처리.
    * 중복 로그인 방지.
* **캐릭터 관리**:
    * 캐릭터 생성, 삭제, 선택.
    * 캐릭터 정보(이름, 클래스, 레벨, 능력치 등) 관리.
* **월드 및 이동**:
    * 플레이어 캐릭터의 월드 내 이동 동기화 (위치, 방향).
    * 이동 유효성 검증 (서버 authoritative).
* **채팅 시스템**:
    * 일반 채팅: 동일 지역 내 플레이어 간 메시지 교환.
    * 귓속말 및 파티 채팅 (확장 가능성을 열어두나, 초기 MVP에는 포함하지 않음).
* **전투 시스템**:
    * 플레이어 간의 공격 및 피해 계산 (PVP).
    * 몬스터와의 공격 및 피해 계산 (PVE).
    * 스킬 사용 및 효과 처리.
    * 공격 대상 선택 및 유효성 검증.
* **아이템 및 인벤토리**:
    * 아이템 획득, 사용, 버리기, 장착/해제.
    * 캐릭터별 인벤토리 관리.
    * 아이템 속성 및 수량 관리.
* **몬스터/NPC 관리**:
    * 몬스터의 생성, 소멸 및 이동 관리.
    * 몬스터의 공격 패턴 및 AI (간단한 형태).
    * NPC 상호작용 (간단한 대화).

### 3.3. 데이터베이스 연동

* **MySQL 8.0 연동**: MySQL 데이터베이스에 계정, 캐릭터, 인벤토리, 아이템 속성, 몬스터 스탯 등 게임에 필요한 모든 데이터를 영속적으로 저장하고 로드해야 합니다.
* **비동기 DB 쿼리 처리**: DB 작업으로 인해 게임 서버의 메인 로직이 블로킹되지 않도록 비동기 쿼리 시스템을 구현해야 합니다.
* **DB 커넥션 풀**: 데이터베이스 연결을 효율적으로 관리하고 재사용하여 성능 오버헤드를 줄여야 합니다.

### 3.4. 모니터링 및 로깅

* **spdlog 기반 로깅**: 고성능 로깅 라이브러리인 spdlog를 사용하여 서버 동작 로그, 에러 로그, 디버그 로그 등을 기록해야 합니다.
* **서버 상태 모니터링**: CPU, 메모리, 네트워크 트래픽 등 서버 자원 사용률을 모니터링하고 이상 징후를 감지해야 합니다. (기본적인 로그 또는 툴 연동)

### 3.5. 테스트

* **단위 테스트**: Google Test 프레임워크를 활용하여 서버의 개별 모듈 및 핵심 기능들의 정확성을 검증해야 합니다.
* **더미 클라이언트 기반 기능/부하 테스트**: `DummyClient` 프로젝트를 사용하여 `MainServer`의 기능 테스트, 안정성 테스트, 동시 접속자 환경에서의 부하 테스트를 수행해야 합니다.

## 4. 성능 요구 사항 (Performance Requirements)

`ArcCore` 서버는 다음의 성능 요구 사항을 충족해야 합니다. 이 요구 사항들은 서버의 안정성과 사용자 경험을 보장하기 위한 최소 기준입니다.

### 4.1. 동시 접속자 처리

* **최대 동시 접속자 수**: 최소 **500명**의 동시 접속자를 안정적으로 처리할 수 있어야 합니다.

### 4.2. 응답 시간 (Latency)

* **평균 패킷 처리 응답 시간**: 클라이언트로부터 패킷 수신 후 처리 및 응답 패킷 전송까지의 평균 응답 시간은 **150ms 이내**여야 합니다.

### 4.3. 처리량 (Throughput)

* **초당 트랜잭션 수 (TPS)**: 초당 **1,000 TPS** (게임 로직 관련 주요 패킷 처리 기준) 이상을 처리할 수 있어야 합니다.

### 4.4. 자원 사용률

* **CPU 사용률**: 최대 동시 접속자 수 및 TPS 달성 시, 서버 CPU 사용률은 **80% 이내**여야 합니다.
* **메모리 사용률**: 최대 동시 접속자 수 달성 시, 서버 메모리 사용률은 **전체 할당량의 70% 이내**여야 합니다.

## 5. 기능 요구 사항 우선순위 (Priority of Functional Requirements)

아래는 기능 요구 사항의 구현 우선순위를 나타냅니다. '필수' 기능은 프로젝트의 핵심이며 반드시 구현되어야 합니다. '높음'은 필수 다음으로 중요하며 포트폴리오의 완성도를 높이는 기능입니다. '보통'은 시간적 여유가 있을 때 고려할 수 있는 기능입니다.

### 5.1. 최우선 (Must-Have)

* **네트워크 통신 전반**:
    * IOCP 기반 비동기 네트워크 처리
    * TCP/IP 통신
    * Protobuf 기반 패킷 직렬화/역직렬화
    * 클라이언트 세션 관리
* **계정 및 로그인/로그아웃**:
    * 사용자 계정 생성 및 관리
    * 서버 로그인 및 로그아웃 처리
    * 중복 로그인 방지
* **캐릭터 관리**:
    * 캐릭터 생성, 삭제, 선택
    * 캐릭터 정보(이름, 클래스, 레벨, 능력치 등) 관리
* **월드 및 이동**:
    * 플레이어 캐릭터의 월드 내 이동 동기화
    * 이동 유효성 검증
* **데이터베이스 연동 전반**:
    * MySQL 8.0 연동 (계정/캐릭터 데이터 필수)
    * 비동기 DB 쿼리 처리
    * DB 커넥션 풀
* **모니터링 및 로깅**:
    * spdlog 기반 로깅
* **테스트**:
    * 단위 테스트 (핵심 모듈)
    * 더미 클라이언트 기반 기능 테스트 (핵심 기능)

### 5.2. 중요 (Should-Have)

* **채팅 시스템**:
    * 일반 채팅
* **전투 시스템 (기본 공격 및 피해)**:
    * 플레이어 간 공격 및 피해 계산 (PVP)
    * 몬스터와의 공격 및 피해 계산 (PVE)
    * 공격 대상 선택 및 유효성 검증
* **아이템 및 인벤토리 (기본)**:
    * 아이템 획득, 사용, 버리기
    * 캐릭터별 인벤토리 관리 (기본 슬롯)
* **몬스터/NPC 관리 (기본)**:
    * 몬스터의 생성, 소멸 및 이동 관리
    * 몬스터의 공격 패턴 및 AI (간단한 형태)

### 5.3. 고려 (Could-Have, 시간 여유 시)

* **채팅 시스템 확장**: 귓속말 및 파티 채팅.
* **전투 시스템 확장**: 스킬 사용 및 효과 처리 (고급).
* **아이템 및 인벤토리 확장**: 장착/해제 기능, 아이템 드랍, 상점 기능.
* **몬스터/NPC 관리 확장**: NPC 상호작용 (고급 대화/퀘스트 부여).
* **서버 상태 모니터링 강화**: 상세한 지표 수집 및 시각화 툴 연동.
* **부하 테스트 결과 분석 심화**: 500명 이상 시뮬레이션 및 병목 지점 상세 분석.

---