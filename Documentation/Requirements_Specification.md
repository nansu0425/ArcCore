# 📋 ArcCore 프로젝트 요구 사항 명세서

## 1. 개요

`ArcCore`는 C++ 기반의 고성능 MMORPG 게임 서버 포트폴리오 프로젝트로, 안정적인 동시 접속 처리와 효율적인 게임 데이터 관리에 중점을 둡니다. 본 문서는 `ArcCore` 서버가 제공하는 주요 기능 및 시스템 성능 요구 사항을 정의합니다.

## 2. 핵심 기술 스택

* **언어**: C++17
* **입출력 모델**: IOCP (I/O Completion Port)
* **네트워크 API**: Winsock (TCP/IP)
* **데이터베이스**: MySQL 8.0
* **직렬화**: Google Protobuf
* **패키지 관리**: vcpkg
* **로깅**: spdlog
* **테스트**: Google Test
* **클라이언트**: Unity 6.0 LTS

## 3. 기능 요구 사항 (Functional Requirements)

### 3.1. 네트워크 통신

* **IOCP 기반 비동기 네트워크 처리**: 고성능 및 확장성을 위해 IOCP 모델을 사용하여 다수의 클라이언트 요청을 효율적으로 처리해야 합니다.
* **TCP/IP 통신**: 안정적인 데이터 전송을 위해 TCP/IP 프로토콜을 사용해야 합니다.
* **패킷 직렬화/역직렬화**: Google Protobuf를 활용하여 효율적이고 견고한 패킷 구조를 정의하고, 클라이언트-서버 간 데이터 통신에 사용해야 합니다.
* **클라이언트 세션 관리**: 접속한 클라이언트들의 연결 상태를 관리하고, 유효하지 않은 세션은 적절히 처리해야 합니다.

### 3.2. 게임 로직 및 시스템

* **플레이어 관리**:
    * **로그인/로그아웃**: 클라이언트의 로그인 요청을 처리하고, 유효한 사용자 인증 후 게임 접속을 허용해야 합니다.
    * **캐릭터 생성/선택**: 새로운 캐릭터 생성 및 기존 캐릭터 선택 기능을 제공해야 합니다.
    * **플레이어 이동 동기화**: Unity 클라이언트와 연동하여 실시간으로 플레이어의 이동 정보를 동기화해야 합니다.
* **월드/오브젝트 관리**:
    * **존(Zone) 기반 관리**: 게임 월드를 여러 존으로 나누어 관리하며, 존 간 이동 시 플레이어 데이터를 효율적으로 전환해야 합니다.
    * **오브젝트 동기화**: 맵 상의 다른 플레이어, NPC 등 오브젝트의 위치 및 상태 변화를 동기화해야 합니다.
* **채팅 시스템**:
    * **일반 채팅**: 게임 내 모든 플레이어가 참여하는 공개 채팅 기능을 제공해야 합니다.
    * **귓속말/파티 채팅 (향후 확장 예정)**: 특정 플레이어 또는 그룹 간의 비공개 채팅 기능을 지원할 수 있도록 설계해야 합니다.
* **전투 시스템**:
    * **공격/피격 처리**: 플레이어 및 몬스터 간의 공격 및 피격 로직을 서버에서 authoritative하게 처리해야 합니다.
    * **스킬 사용**: 플레이어의 스킬 사용 요청을 처리하고, 스킬 효과 및 범위 적용을 계산해야 합니다.
    * **HP/MP 관리**: 캐릭터의 체력 및 마나를 서버에서 관리하고 클라이언트와 동기화해야 합니다.
* **인벤토리/아이템 시스템**:
    * **인벤토리 관리**: 플레이어의 아이템 소지 정보를 서버에서 관리해야 합니다.
    * **아이템 획득/사용/버리기**: 아이템 획득, 사용, 버리기 등 기본적인 아이템 조작을 서버에서 처리해야 합니다.
    * **아이템 정보 관리**: 데이터베이스를 통해 아이템의 속성 및 통계 정보를 관리해야 합니다.
* **몬스터 관리**:
    * **몬스터 스폰**: 몬스터의 스폰 위치, 시간, 수량 등을 관리하고, 몬스터를 게임 월드에 생성해야 합니다.
    * **몬스터 AI**: 몬스터의 이동, 공격, 스킬 사용 등 기본적인 AI를 구현해야 합니다.
    * **몬스터 행동 패턴**: 몬스터의 다양한 행동 패턴(예: 순찰, 추격, 도망)을 정의하고, 상황에 따라 적절한 행동을 선택해야 합니다.
    * **몬스터 상태 관리**: 몬스터의 체력, 공격력, 방어력 등 상태 정보를 관리하고, 사망 시 처리 로직을 구현해야 합니다.
    * **전리품 드롭**: 몬스터 사망 시 아이템 또는 재화를 드롭하는 로직을 구현해야 합니다.
* **NPC 관리**:
    * **NPC 상호 작용**: NPC와 플레이어 간의 대화, 퀘스트 제공, 상점 이용 등 상호 작용 로직을 구현해야 합니다.
    * **NPC 상태 관리**: NPC의 위치, 대사, 판매 아이템 목록 등 상태 정보를 관리해야 합니다.
* **퀘스트 시스템**:
    * **퀘스트 생성/관리**: 퀘스트의 내용, 목표, 보상 등을 정의하고, 퀘스트 진행 상태를 관리해야 합니다.
    * **퀘스트 진행**: 플레이어가 퀘스트를 수락하고 완료하는 과정을 처리해야 합니다.
    * **퀘스트 보상**: 퀘스트 완료 시 플레이어에게 보상을 지급하는 로직을 구현해야 합니다.

### 3.3. 데이터베이스 연동

* **MySQL 연동**: MySQL 8.0 데이터베이스를 사용하여 게임 데이터를 저장하고 관리해야 합니다.
* **DB 커넥션 풀**: 효율적인 DB 자원 관리를 위해 커넥션 풀을 구현하여 DB 연결 오버헤드를 줄여야 합니다.
* **비동기 쿼리 처리**: 게임 서버의 성능에 영향을 주지 않도록 DB 쿼리 처리를 비동기로 수행해야 합니다.
* **데이터 관리**: 캐릭터 정보, 아이템 정보, 스킬 정보, 몬스터 정보, 퀘스트 정보 등 게임에 필요한 모든 데이터를 영속적으로 저장하고 로드해야 합니다.

### 3.4. 모니터링 및 로깅

* **spdlog 기반 로깅**: 고성능 로깅 라이브러리인 spdlog를 사용하여 서버 동작 로그, 에러 로그, 디버그 로그 등을 기록해야 합니다.
* **서버 상태 모니터링**: CPU, 메모리, 네트워크 트래픽 등 서버 자원 사용률을 모니터링하고 이상 징후를 감지해야 합니다.

### 3.5. 테스트

* **단위 테스트**: Google Test 프레임워크를 활용하여 서버의 개별 모듈 및 핵심 기능들의 정확성을 검증해야 합니다.
* **더미 클라이언트 기반 기능/부하 테스트**: `DummyClient` 프로젝트를 사용하여 `MainServer`의 기능 테스트, 안정성 테스트, 동시 접속자 환경에서의 부하 테스트를 수행해야 합니다.

## 4. 성능 요구 사항 (Performance Requirements)

`ArcCore` 서버는 다음의 성능 요구 사항을 충족해야 합니다. 이 요구 사항들은 서버의 안정성과 사용자 경험을 보장하기 위한 최소 기준입니다.

### 4.1. 동시 접속자 처리

* **최대 동시 접속자 수**: 최소 **500명**의 동시 접속자를 안정적으로 처리할 수 있어야 합니다.

### 4.2. 응답 시간 (Latency)

* **평균 패킷 처리 응답 시간**: 클라이언트로부터 패킷 수신 후 처리 및 응답 패킷 전송까지의 평균 응답 시간은 **150ms 이내**여야 합니다. (네트워크 환경 제외)
* **주요 게임 액션 (이동, 공격, 스킬 사용) 응답 시간**: 해당 액션에 대한 서버 처리 후 동기화까지의 응답 시간은 **100ms 이내**여야 합니다.

### 4.3. 처리량 (Throughput)

* **TPS (Transactions Per Second)**: 초당 최소 **1,000 TPS** (주요 게임 액션 기준)를 처리할 수 있어야 합니다.

### 4.4. 자원 사용률

* **CPU 사용률**: 최대 동시 접속자 수 및 최대 TPS 환경에서 서버 프로세스의 평균 CPU 사용률은 **80%를 초과하지 않아야 합니다.**
* **메모리 사용률**: 최대 동시 접속자 수 및 최대 TPS 환경에서 서버 프로세스의 평균 메모리 사용률은 **80%를 초과하지 않아야 합니다.**
* **네트워크 대역폭**: 예상되는 최대 트래픽 상황에서 네트워크 대역폭 사용량이 서버 시스템의 한계치에 도달하지 않아야 합니다.

### 4.5. 안정성

* **연속 서비스 가능 시간**: 예상되는 최대 부하 상태에서 **최소 24시간 동안 중단 없이 안정적으로 서비스**를 제공할 수 있어야 합니다.
* **오류율**: 모든 기능 및 성능 테스트에서 **0.1% 미만의 오류율**을 유지해야 합니다. (데이터베이스 연결 실패, 패킷 처리 오류 등)

---

이 문서는 `ArcCore` 프로젝트의 개발 및 테스트를 위한 기준이 됩니다.